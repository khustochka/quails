- use_jquery
- javascript JQ_UI_FILE, 'suggest_over_combo', 'bulk_observations'
- stylesheet 'autocomplete', 'forms'

- @page_title = 'Bulk add/edit observation'
- blogpost = @observation.post

%h2= @page_title

= render 'admin/shortcuts' if admin_session?

= simple_form_for @observation, :remote => true, :html => {:'data-action' => bulksave_observations_path} do |form|
  %div
    = form.association :locus, :label => 'Location:', :collection => Locus.all_ordered, :label_method => :name_en,
        :input_html => {:class => 'suggest-combo', :name => 'c[locus_id]'}
    = form.input :observ_date, :as => :string, :label => 'Date:', :input_html => {:maxlength => 10, :name => 'c[observ_date]', :type => 'date'}
    = form.input :mine, :label => 'Mine', :input_html => {:name => 'c[mine]'}
    - unless blogpost.nil?
      = form.association(:post, :as => :boolean, :label => post_link(blogpost.title, blogpost), :wrapper_html => {:class => 'flat'})
  .input.flat.block.to-add-row
    %label{:for => 'species-quick-add'} Quick add species:
    %input{:id => 'species-quick-add', :class => 'string'}
    %span.pseudolink#add-row Add new row

  .obs-row
    = form.association :species, :label => 'Species:', :collection => Species.alphabetic,
        :label_method => :name_sci, :include_blank => false, :input_html => {:class => 'sp-suggest', :name => 'o[][species_id]'}
    = form.input :quantity, :label => 'Quantity:', :input_html => {:name => 'o[][quantity]', :class => :short}
    = form.input :biotope, :label => 'Biotope:', :input_html => {:name => 'o[][biotope]', :class => :short}
    = form.input :place, :label => 'Place:', :input_html => {:name => 'o[][place]'}
    = form.input :notes, :label => 'Notes:', :input_html => {:name => 'o[][notes]'}
    %div.for-remove

  .buttons
    = form.button :submit, :value => 'Save'