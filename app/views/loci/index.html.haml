- javascript 'ujs'

- @page_title = 'Listing locations'

%h1= @page_title

= render 'admin/shortcuts' if current_user.admin?

%p
  = link_to 'Order public locations', action: :public

%table.neat_table.loci_index
  %tr
    %th Code
    %th Parent
    %th Names
    %th.align-center LatLon
    %th Public #
    %th

  - Locus::TYPES.each_with_index do |type, i|
    - if @locus_by_type[i].present?
      %tr
        %td{:colspan => 6}
          %h3= type.pluralize.upcase
        - @locus_by_type[i].each do |locus|
          %tr
            %td= link_to locus.slug, edit_locus_path(locus)
            %td= locus.parent.try(:slug) || '-'
            %td= %w(en ru uk).map{|lang| "#{lang}: #{locus.send("name_#{lang}")}"}.join('<br />').html_safe
            %td.align-center= latlon(locus)
            %td= locus.public_index
            %td
              - if locus.children.count > 0 || locus.observations.count > 0
                = image_tag('/img/x_alt_16x16_tan.png', :title => 'Destroy disabled due to existing associations')
              - else
                = default_destroy_link(locus)
