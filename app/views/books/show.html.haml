- @page_title = "[#{@book.name}]"

%h1= @page_title

= render 'admin/shortcuts' if current_user.admin?

%dl
  %dt
    %b= @book.slug
  %dd
    %i= @book.description

%h2= Species

%table.neat_table
  %tr
    %th.align-right No
    %th Scientific name
    %th Global species
    %th Names
    %th.align-right Avibase id

  - @taxa.group_by_family.each do |fam, species_list|
    %tr
      %td
      %td{:colspan => 4}
        %h3= "#{fam[:order].upcase}: #{fam[:family]}"
    - species_list.each do |species|
      %tr
        %td.align-right= species.index_num
        %td
          %i
            %b= link_to(species.name_sci, [@book, species])
          %span.less-important= species.authority
        %td
          - if species.species
            = link_to(content_tag(:i, species_link(species.species, species.species.name_sci)), species.species)
          - if species.species.nil? || species.name_sci != species.species.name_sci
            %span.big-red *
        %td
          - %w(en ru uk).each do |lang|
            %div
              %i.less-important.monospace= "#{lang}:"
              = species.send("name_#{lang}")
        %td.align-right= link_to(species.avibase_id, avibase_species_url(species.avibase_id)) if species.avibase_id

