- stylesheet 'forms'
- javascript 'card_form'

- @page_title = "#{new_or_edit_label(@card)} card"

%h1= page_header

= render 'admin/shortcuts' if current_user.admin?

= simple_form_for(@card) do |form|
  = form.error_notification

  %div
    = form.association :locus, label: 'Location:', collection: Locus.list_order,
        input_html: {class: 'suggest-combo'}
    = form.input :observ_date, as: :string, label: 'Date:',
          input_html: {class: 'short', maxlength: 10, type: 'date'}
    - if @blogpost
      %div.input.boolean.optional.flat
        = hidden_field_tag("c[post_id]")
        = check_box_tag("c[post_id]", @blogpost.id, true, class: "boolean optional", id: "observation_post_id")
        %label.boolean.optional{for: "observation_post_id"}= post_link(@blogpost.formatted.title, @blogpost)

    = form.input :autogenerated

  = form.input :biotope
  = form.input :weather
  = form.input :time
  = form.input :route
  = form.input :observers
  = form.input :with_me, label: 'With me'
  = form.input :notes, input_html: {rows: 7}

  = form.simple_fields_for :observations do |form2|
    %div.obs-row
      = form2.input :id, as: :string,
          input_html: {readonly: true, disabled: true, class: :id_field}
      = form2.association :species, label: 'Species:', collection: species_for_select,
          include_blank: true, required: false, input_html: {class: 'sp-suggest'}
      = form2.input :quantity, label: 'Quantity:', input_html: {class: :short}
      = form2.input :notes, label: 'Notes:'
      -#%div.input.boolean
      -#  = check_box_tag nil, '1', obs.voice, id: 'observation_voice', class: 'boolean'
      -#  %label.boolean{:for => 'observation_voice'} Voice?
      = form2.input :voice, label: 'Voice?'
      = form2.input :place, label: 'Place:'

  .buttons
    = default_submit_button(form)
