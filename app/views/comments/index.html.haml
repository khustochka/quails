- javascript 'pjax_pagination'

- @page_title = 'Listing comments'

%h1= page_header

%p
  - if params[:sort] == 'by_post'
    = link_to 'Show latest first', sort: nil
  - else
    = link_to 'Group by post', sort: 'by_post'

%table.neat_table
  %tr
    %th Id
    %th Parent
    %th Name
    %th Text
    %th

  - @comments.group_by(&:post).each do |post, comments|
    %tr
      %td{:colspan => 5}
        %h4= post_link(post_title(post), post)
    - comments.each do |comment|
      %tr
        %td= link_to comment.id, edit_comment_path(comment)
        %td= comment.parent_id
        %td= comment.name
        %td= comment_filter(comment.text)
        %td= default_destroy_link(comment)

= paginate @comments unless params[:sort] == 'by_post'
